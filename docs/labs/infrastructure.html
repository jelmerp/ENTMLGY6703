<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jelmer Poelstra">
<meta name="dcterms.date" content="2024-01-26">

<title>ENTMLGY 6703 - Jelmer’s lectures - Week 3 lab — part 1:Computational Infrastructure</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">ENTMLGY 6703 - Jelmer’s lectures</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> <i class="bi bi-house" role="img">
</i> 
<span class="menu-text"> </span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-week-3-hts" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Week 3: HTS</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-week-3-hts">    
        <li>
    <a class="dropdown-item" href="../lectures/sequencing.html">
 <span class="dropdown-text">Lecture: High-throughput Sequencing &amp; Genomes</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../labs/infrastructure.html">
 <span class="dropdown-text">Lab part 1: Computational Infrastructure</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../labs/data.html">
 <span class="dropdown-text">Lab part 2: Working with genome and HTS Data</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-week-4-rna-seq" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Week 4: RNA-seq</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-week-4-rna-seq">    
        <li>
    <a class="dropdown-item" href="../lectures/rnaseq.html">
 <span class="dropdown-text">Lecture: RNA-seq</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../labs/DE.html">
 <span class="dropdown-text">Lab: Differential expression analysis</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-other-pages" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Other Pages</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-other-pages">    
        <li>
    <a class="dropdown-item" href="../r_homework.html">
 <span class="dropdown-text">R Homework</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/jelmerp/ENTMLGY6703">
            Source Code
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/jelmerp/ENTMLGY6703/issues/new">
            Report an Issue
            </a>
          </li>
      </ul>
    </div>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction-to-the-lab" id="toc-introduction-to-the-lab" class="nav-link active" data-scroll-target="#introduction-to-the-lab"><span class="header-section-number">1</span> Introduction to the lab</a></li>
  <li><a href="#computational-infrastructure-overview" id="toc-computational-infrastructure-overview" class="nav-link" data-scroll-target="#computational-infrastructure-overview"><span class="header-section-number">2</span> Computational infrastructure overview</a></li>
  <li><a href="#the-ohio-supercomputer-center-osc" id="toc-the-ohio-supercomputer-center-osc" class="nav-link" data-scroll-target="#the-ohio-supercomputer-center-osc"><span class="header-section-number">3</span> The Ohio Supercomputer Center (OSC)</a>
  <ul class="collapse">
  <li><a href="#introduction-to-supercomputers" id="toc-introduction-to-supercomputers" class="nav-link" data-scroll-target="#introduction-to-supercomputers"><span class="header-section-number">3.1</span> Introduction to supercomputers</a></li>
  <li><a href="#introduction-to-osc" id="toc-introduction-to-osc" class="nav-link" data-scroll-target="#introduction-to-osc"><span class="header-section-number">3.2</span> Introduction to OSC</a></li>
  <li><a href="#the-osc-ondemand-web-portal" id="toc-the-osc-ondemand-web-portal" class="nav-link" data-scroll-target="#the-osc-ondemand-web-portal"><span class="header-section-number">3.3</span> The OSC OnDemand web portal</a></li>
  </ul></li>
  <li><a href="#the-vs-code-text-editor" id="toc-the-vs-code-text-editor" class="nav-link" data-scroll-target="#the-vs-code-text-editor"><span class="header-section-number">4</span> The VS Code text editor</a>
  <ul class="collapse">
  <li><a href="#what-is-vs-code" id="toc-what-is-vs-code" class="nav-link" data-scroll-target="#what-is-vs-code"><span class="header-section-number">4.1</span> What is VS Code?</a></li>
  <li><a href="#connecting-to-vs-code" id="toc-connecting-to-vs-code" class="nav-link" data-scroll-target="#connecting-to-vs-code"><span class="header-section-number">4.2</span> Connecting to VS Code</a></li>
  <li><a href="#the-vs-code-user-interface" id="toc-the-vs-code-user-interface" class="nav-link" data-scroll-target="#the-vs-code-user-interface"><span class="header-section-number">4.3</span> The VS Code User Interface</a></li>
  </ul></li>
  <li><a href="#the-unix-shell" id="toc-the-unix-shell" class="nav-link" data-scroll-target="#the-unix-shell"><span class="header-section-number">5</span> The Unix shell</a>
  <ul class="collapse">
  <li><a href="#what-is-the-unix-shell" id="toc-what-is-the-unix-shell" class="nav-link" data-scroll-target="#what-is-the-unix-shell"><span class="header-section-number">5.1</span> What is the Unix shell?</a></li>
  <li><a href="#first-steps-in-the-unix-shell" id="toc-first-steps-in-the-unix-shell" class="nav-link" data-scroll-target="#first-steps-in-the-unix-shell"><span class="header-section-number">5.2</span> First steps in the Unix shell</a></li>
  <li><a href="#cd-and-command-actions-arguments" id="toc-cd-and-command-actions-arguments" class="nav-link" data-scroll-target="#cd-and-command-actions-arguments"><span class="header-section-number">5.3</span> <code>cd</code> and command actions &amp; arguments</a></li>
  <li><a href="#ls-and-command-options" id="toc-ls-and-command-options" class="nav-link" data-scroll-target="#ls-and-command-options"><span class="header-section-number">5.4</span> <code>ls</code> and command <em>options</em></a></li>
  <li><a href="#a-few-more-general-shell-tips" id="toc-a-few-more-general-shell-tips" class="nav-link" data-scroll-target="#a-few-more-general-shell-tips"><span class="header-section-number">5.5</span> A few more general shell tips</a></li>
  </ul></li>
  <li><a href="#appendix-further-learning" id="toc-appendix-further-learning" class="nav-link" data-scroll-target="#appendix-further-learning"><span class="header-section-number">6</span> Appendix: Further learning</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Week 3 lab — part 1:<br>Computational Infrastructure</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jelmer Poelstra </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 26, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p><br></p>
<section id="introduction-to-the-lab" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="introduction-to-the-lab"><span class="header-section-number">1</span> Introduction to the lab</h2>
<p>In today’s lab:</p>
<ul>
<li><p>We will start with learning about a typical “computational infrastructure” to analyze high-throughput sequencing (HTS) data — <strong>this page</strong>.</p></li>
<li><p>We will then use that infrastructure to start the exploration of an HTS dataset. We’ll check out reference genome and HTS read files, and perform read quality control – <a href="../labs/data.html"><strong>the next page</strong></a>.</p></li>
</ul>
<p><br></p>
</section>
<section id="computational-infrastructure-overview" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="computational-infrastructure-overview"><span class="header-section-number">2</span> Computational infrastructure overview</h2>
<p>Due in large part to the amount of data involved, a laptop or desktop computer is often not sufficient to work with HTS data, or with large-scale genomics and transcriptomics data more generally.</p>
<p>Additionally, most of the specialized programs that help you analyze your data can only be run through a “command-line interface”.</p>
<p>Therefore, a typical computational infrastructure to do what we may call “command-line genomics” involves:</p>
<ol type="1">
<li>A <strong>supercomputer</strong><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> — in our case, the Ohio Supercomputer Center (OSC)</li>
<li>A <strong>text editor</strong> — I recommend and will demonstrate VS Code</li>
<li>The <strong>Unix shell</strong> (terminal)</li>
<li><strong>R</strong> (or perhaps Python) for interactive statistical analysis and visualization.</li>
</ol>
<p>Today, we will go through the first three of the abovementioned items: on this page, we’ll get familiar with them, and on the next page, we’ll apply what we learned to some reference genome and HTS read data.</p>
<p>In the lab next week, we will cover the fourth in the context of RNA-seq differential expression analysis.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Side note: “I don’t think I like coding. Can I avoid all of this?” <em>(Click to expand)</em>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>If you will often be doing genomics projects like the ones mentioned above, it’s hard to avoid using this (kind of) infrastructure. But here are some conditions in which you might reasonably avoid it:</p>
<ul>
<li>You’re doing a single genomics project, your main research focus is elsewhere</li>
<li>You’re willing to outsource part of the analysis</li>
</ul>
<p>Note that for several types of HTS projects, including those involving metabarcoding or RNA-seq data (as we’ll see next week), the analysis consists of two distinct parts:</p>
<ol type="1">
<li>The first is compute-heavy and involves command-line programs; it is also quite standardized, and therefore suitable to be outsourced.</li>
<li>The second can be done on a laptop and in terms of coding only requires R</li>
</ol>
<p>You could also try a platform like <a href="https://usegalaxy.org"><strong><em>Galaxy</em></strong></a>, which has a web browser interface and doesn’t require coding — but I wouldn’t recommend this if you’re going to do multiple genomics projects.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Side note: Advantages of command-line interfaces <em>(Click to expand)</em>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Advantages of Command-Line Interfaces (CLIs) over “Graphical User Interfaces” (GUIs) include:</p>
<ul>
<li><p><strong>Efficiency</strong> — A CLI allows you to write a simple loop to run it in the same way for many samples.<br>
(In combination with usage of a supercomputer, you can process all those samples <em>in parallel</em>.)</p></li>
<li><p><strong>Reproducibility</strong> — You can easily save all commands &amp; scripts, making it straightforward to rerun/adapt an analysis.</p></li>
</ul>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="the-ohio-supercomputer-center-osc" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="the-ohio-supercomputer-center-osc"><span class="header-section-number">3</span> The Ohio Supercomputer Center (OSC)</h2>
<section id="introduction-to-supercomputers" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="introduction-to-supercomputers"><span class="header-section-number">3.1</span> Introduction to supercomputers</h3>
<p>A supercomputer is a highly interconnected set of many computer processors and storage units. You can think of it simply as a <strong>network of computers</strong> — with individual computers called “nodes”.</p>
<p>Supercomputers are also commonly referred to as <em>High-Performance Computing (<strong>HPC</strong>) clusters</em> or simply <strong>compute clusters</strong>. This is what Owens, one of the OSC supercomputers, physically looks like:</p>
<p align="center">
</p><p><img src="img_hts/owens.jpg" width="50%"></p>
<p></p>
<p>Why you might need a supercomputer:</p>
<ul>
<li>Often, your genomics <strong>dataset is too large</strong> to be handled efficiently, or at all, by a laptop/desktop computer.</li>
<li>To <strong>speed up</strong> <em>long-running analyses</em> by using more computing power, and <em>repeated analyses</em> (like the independent alignment of reads for different samples) by running them in parallel.</li>
<li>It’s also a great place to <strong>store</strong> large amounts of data — and genomics data is often very large.</li>
</ul>
<hr style="height:1pt; visibility:hidden;">
</section>
<section id="introduction-to-osc" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="introduction-to-osc"><span class="header-section-number">3.2</span> Introduction to OSC</h3>
<p align="center">
</p><p><img src="img_hts/osc_logo.png" width="70%"></p>
<p></p>
<p>The <strong>Ohio Supercomputer Center (OSC)</strong> provides computing resources to researchers (and others) across Ohio. OSC has two supercomputers/clusters (named <strong>Owens</strong> and <strong>Pitzer</strong>), and lots of infrastructure for their usage. Research usage is charged at <a href="https://www.osc.edu/content/academic_fee_model_faq">subsidized rates</a>, and in most case, these costs are absorbed at the college level.</p>
<section id="the-structure-of-an-osc-supercomputer" class="level4">
<h4 class="anchored" data-anchor-id="the-structure-of-an-osc-supercomputer">The structure of an OSC supercomputer</h4>
<p>We can think of a supercomputer as having three main parts:</p>
<ul>
<li><strong>File Systems</strong>: Where files are stored (these are shared between the two OSC clusters)</li>
<li><strong>Login Nodes</strong>: The handful of computers everyone shares after logging in</li>
<li><strong>Compute Nodes</strong>: The many computers you can reserve to run your analyses</li>
</ul>
<p align="center">
</p><p><img src="img_hts/cluster_overview_ed.png" width="85%"></p>
<p></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Side note: What works differently on a supercomputer like at OSC? <em>(Click to expand)</em>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Compared to command-line computing on a laptop or desktop, the following aspects are different when working on a supercomputer like at OSC:</p>
<ul>
<li><strong>Login versus compute nodes</strong><br>
“Login nodes”, the nodes you end up on after logging in, are not meant for heavy computing and you have to <em>request access to “compute nodes”</em> to run most analyses.</li>
<li><strong>“Non-interactive” computing is common</strong><br>
It is common to write and “submit” scripts to a queue instead of running programs interactively.</li>
<li><strong>Software</strong><br>
You generally can’t install “the regular way”, and a lot of installed software needs to be “loaded” (as we’ll see today).</li>
<li><strong>Operating system</strong><br>
Supercomputers run on the Linux operating system</li>
</ul>
</div>
</div>
</div>
<hr style="height:1pt; visibility:hidden;">
</section>
</section>
<section id="the-osc-ondemand-web-portal" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="the-osc-ondemand-web-portal"><span class="header-section-number">3.3</span> The OSC OnDemand web portal</h3>
<p><i class="fa-solid fa-user-edit" aria-label="user-edit"></i> <strong>Go to <a href="https://ondemand.osc.edu" class="uri">https://ondemand.osc.edu</a> and log in</strong> with your OSC (not OSU!) credentials.</p>
<p>You should see a landing page similar to the one below:</p>
<p align="center">
</p><p><img src="img_hts/ondemand_home.png" width="95%"></p>
<p></p>
<p>We will now go through some of the dropdown menus in the <strong>blue bar along the top</strong>.</p>
<section id="files-file-system-access" class="level4">
<h4 class="anchored" data-anchor-id="files-file-system-access"><strong>Files</strong>: File system access</h4>
<p>Hovering over the <strong>Files</strong> dropdown menu gives a list of directories (=folders, and “dir” for short) that you have access to. If your account is brand new, you should only two directories listed<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>:</p>
<ol type="1">
<li>A <strong>Home</strong> directory (starts with <code>/users/</code>)</li>
<li>A project “<strong>scratch</strong>” directory (starts with <code>/fs/scratch/</code>) <code>PAS2250</code></li>
</ol>
<p>Select the <code>PAS2250</code> scratch directory, <code>/fs/scratch/PAS2250</code>, where we’ll be working today and next week:</p>
<p align="center">
</p><p><img src="img_hts/ondemand_files_PAS2250.png" width="45%"></p>
<p></p>
<p>Once there, you should see a list of directories and files (here: just a single dir), and you can click on the directories to explore the contents further:</p>
<p align="center">
</p><p><img src="img_hts/ondemand_files_PAS2250_2.png" width="95%"></p>
<p></p>
<p>This interface is <strong>much like the file browser on your own computer</strong>, so you can also create, delete, move and copy files and folders, and even upload (from your computer to OSC) and download (from OSC your computer) files<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> — see the buttons across the top.</p>
<details>
<summary>
<i class="fa-solid fa-user-edit" aria-label="user-edit"></i> <strong>Your Turn</strong>: Create your own folder <em>(click to see instructions)</em>
</summary>
<ul>
<li>Click your way into <code>ENT6703</code> within <code>/fs/scratch/PAS2250</code> if you’re not already there.</li>
<li>You should (at least) see directories/folders named <code>share</code> and <code>jelmer</code>.</li>
<li>Create your own folder by clicking the <code>New Directory</code> button at the top.</li>
<li>Please give it the <strong>exact same name as your OSC username</strong> (including any capitalization).</li>
</ul>
<p><em>(You can see what your username is by looking at the right side of the blue top bar:)</em></p>
<p align="center">
</p><p><img src="img_hts/username.png" width="40%"></p>
<p></p>
</details>
</section>
<section id="clusters-unix-shell-access" class="level4">
<h4 class="anchored" data-anchor-id="clusters-unix-shell-access"><strong>Clusters</strong>: Unix shell access</h4>
<p>Interacting with a supercomputer is most commonly done using a Unix shell, and we’ll learn about the basics of doing so soon. Under the <strong>Clusters</strong> dropdown menu, you can access a Unix shell either on Owens or Pitzer:</p>
<p align="center">
</p><p><img src="img_hts/ondemand_shell_select.png" width="50%"></p>
<p></p>
<p>I’m selecting a shell on the Pitzer supercomputer, which will open a new browser tab looking like this:</p>
<p align="center">
</p><p><img src="img_hts/ondemand_shell2.png" width="95%"></p>
<p></p>
<p>However, from now on, we’ll be accessing a Unix shell <strong>inside the VS Code text editor</strong>, which also gives us some additional functionality in a user-friendly way.</p>
</section>
<section id="interactive-apps" class="level4">
<h4 class="anchored" data-anchor-id="interactive-apps">Interactive Apps</h4>
<p>We can access programs with Graphical User Interfaces (GUIs; point-and-click interfaces) via the <strong>Interactive Apps</strong> dropdown menu — let’s select VS Code using the “Code Server” button:</p>
<p align="center">
</p><p><img src="img_hts/ondemand_vscode_select.png" width="31%"></p>
<p></p>
<p><br></p>
</section>
</section>
</section>
<section id="the-vs-code-text-editor" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="the-vs-code-text-editor"><span class="header-section-number">4</span> The VS Code text editor</h2>
<section id="what-is-vs-code" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="what-is-vs-code"><span class="header-section-number">4.1</span> What is VS Code?</h3>
<p>VS Code (in full, Visual Studio Code) is basically a fancy text editor.</p>
<p>To emphasize the additional functionality relative to basic text editors like Notepad and TextEdit, editors like VS Code are also referred to as “<strong>IDEs</strong>”: <em>Integrated Development Environments</em>. The RStudio program is another good example of an IDE. For our purposes:</p>
<ul>
<li>VS code will be our IDE for Unix shell code (this week)</li>
<li>RStudio will be our IDE for R (in the differential expression lab next week)</li>
</ul>
<hr style="height:1pt; visibility:hidden;">
</section>
<section id="connecting-to-vs-code" class="level3" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="connecting-to-vs-code"><span class="header-section-number">4.2</span> Connecting to VS Code</h3>
<p>Because Interactive Apps like VS Code and RStudio <strong>run on compute nodes</strong> (not login nodes), which need to be “reserved”, we have to fill out a form and specify the following details (see also the screenshot below):</p>
<table class="table">
<colgroup>
<col style="width: 59%">
<col style="width: 40%">
</colgroup>
<thead>
<tr class="header">
<th>Option</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>The OSC <code>Project</code> that should be billed for the compute resource usage</td>
<td><code>PAS2250</code></td>
</tr>
<tr class="even">
<td>The <code>Number of hours</code> we want to make a reservation for<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></td>
<td><code>4</code></td>
</tr>
<tr class="odd">
<td>The <code>Working Directory</code><a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a> for the program</td>
<td>your newly-created personal folder in <code>/fs/scratch/PAS2250/ENT6703</code> (e.g.&nbsp;<code>/fs/scratch/PAS2250/ENT6703/jelmer</code>)</td>
</tr>
<tr class="even">
<td>The <code>Codeserver Version</code></td>
<td><code>4.8</code></td>
</tr>
</tbody>
</table>
<p align="center">
</p><p><img src="img_hts/ondemand_vscode_form2.png" width="60%"></p>
<p></p>
<p>Click on <strong>Launch</strong> at the bottom, which will send your request to the “compute job” scheduler. First, your job will be “<em>Queued</em>” — that is, waiting for the job scheduler to allocate resources on the compute nodes to it:</p>
<p align="center">
</p><p><img src="img_hts/ondemand_vscode_queued.png" width="75%"></p>
<p></p>
<p>Your job is typically granted resources within a few seconds (the card will then say “<em>Starting</em>”), and be ready for usage (“<em>Running</em>”) in another couple of seconds:</p>
<p align="center">
</p><p><img src="img_hts/ondemand_vscode_running.png" width="75%"></p>
<p></p>
<p>Then, click on the blue <strong>Connect to VS Code</strong> button to open VS Code in a new browser tab. When VS Code opens, you may get these two pop-ups — click “Yes” (and check the box) and “Don’t Show Again”, respectively:</p>
<div class="columns">
<div class="column" style="width:52%;">
<p align="center">
</p><p><img src="img_hts/vscode-trust2.png" width="90%"></p>
<p></p>
</div><div class="column" style="width:48%;">
<p align="center">
</p><p><img src="img_hts/vscode-git.png" width="90%"></p>
<p></p>
</div>
</div>
<hr style="height:1pt; visibility:hidden;">
</section>
<section id="the-vs-code-user-interface" class="level3" data-number="4.3">
<h3 data-number="4.3" class="anchored" data-anchor-id="the-vs-code-user-interface"><span class="header-section-number">4.3</span> The VS Code User Interface</h3>
<p align="left">
</p><p><img src="img_hts/vscode-welcome_ed.png" width="80%"></p>
<p></p>
<section id="side-bars" class="level4">
<h4 class="anchored" data-anchor-id="side-bars">Side bars</h4>
<p>The <strong>Activity Bar</strong> (narrow side bar) on the far left has:</p>
<ul>
<li>A &nbsp; <i class="fa-solid fa-bars" aria-label="bars"></i> &nbsp; (“hamburger menu”), which has menu items like <code>File</code> that you often find in a top bar.</li>
<li>A &nbsp; <i class="fa-solid fa-cog" aria-label="cog"></i> &nbsp; (cog wheel icon) in the bottom, through which you can mainly access <em>settings</em>.</li>
<li>Icons to toggle <strong>(wide) Side Bar</strong> options — but we’ll only use the default selection, the <em>Explorer</em> (file browser)</li>
</ul>
</section>
<section id="editor-pane-and-welcome-document" class="level4">
<h4 class="anchored" data-anchor-id="editor-pane-and-welcome-document">Editor pane and <code>Welcome</code> document</h4>
<p>The main part of the VS Code is the <strong>editor pane</strong>. Here, we can open files like scripts and other types of text files, and images. (Whenever you open VS Code, an editor tab with a <code>Welcome</code> document is automatically opened. This provides some help and some shortcuts like to recently opened files and folders.)</p>
</section>
<section id="terminal-with-a-unix-shell" class="level4">
<h4 class="anchored" data-anchor-id="terminal-with-a-unix-shell">Terminal (with a Unix shell)</h4>
<p><i class="fa-solid fa-user-edit" aria-label="user-edit"></i> <strong>Open a terminal</strong> by clicking &nbsp; <i class="fa-solid fa-bars" aria-label="bars"></i> &nbsp; =&gt; <code>Terminal</code> =&gt; <code>New Terminal</code>.</p>
<hr style="height:1pt; visibility:hidden;">
<details>
<summary>
<i class="fa-solid fa-user-edit" aria-label="user-edit"></i> <strong>Your Turn</strong>: Try a few color themes <em>(click to see instructions)</em>
</summary>
<ol type="1">
<li>Access the “Color Themes” option by clicking <i class="fa fa-cog"></i> &nbsp; =&gt; <code>Color Theme</code>.</li>
<li>Try out a few themes and see what you like!</li>
</ol>
</details>
<p><br></p>
</section>
</section>
</section>
<section id="the-unix-shell" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="the-unix-shell"><span class="header-section-number">5</span> The Unix shell</h2>
<section id="what-is-the-unix-shell" class="level3" data-number="5.1">
<h3 data-number="5.1" class="anchored" data-anchor-id="what-is-the-unix-shell"><span class="header-section-number">5.1</span> What is the Unix shell?</h3>
<p>A computer’s <strong>shell</strong> is an interface inside a Terminal window that allows you to interact with your computer by <em>typing commands</em>. It is also referred to as the the “<strong>command line</strong>” — with “command-line tools/programs” being software that is run using shell commands.</p>
<p>The <strong>Unix shell</strong> is the shell of Unix-based operating systems, which include Mac and Linux (but not Windows).</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Many bioinformatics programs are basically specialized commands
</div>
</div>
<div class="callout-body-container callout-body">
<p>We’ll now learn a couple of Unix shell commands, to familiarize yourself with working in this environment.</p>
<p>Doing so is also useful because in many ways, you can think of using a command-line bioinformatics program as using just another Unix command. Therefore, our skills with Unix commands will extend to using command-line bioinformatics tools!</p>
</div>
</div>
<hr style="height:1pt; visibility:hidden;">
</section>
<section id="first-steps-in-the-unix-shell" class="level3" data-number="5.2">
<h3 data-number="5.2" class="anchored" data-anchor-id="first-steps-in-the-unix-shell"><span class="header-section-number">5.2</span> First steps in the Unix shell</h3>
<section id="the-prompt" class="level4">
<h4 class="anchored" data-anchor-id="the-prompt">The prompt</h4>
<p>Inside your terminal, the “prompt” indicates that the shell is ready for a command. Your prompt at OSC should show the following pieces of information:</p>
<pre class="bash-in-nocolor"><code>[&lt;username&gt;@&lt;node-name&gt; &lt;working-dir&gt;]$</code></pre>
<p>For example:</p>
<pre class="bash-in-nocolor"><code>[jelmer@p0080 jelmer]$ </code></pre>
<p>You type your command line expressions <strong>after the dollar sign</strong> <code>$</code>, and then press <kbd>Enter</kbd> to execute them. When it has finished executing, we’ll get our prompt back and can type a new command.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
How shell code is shown on this website
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>The gray boxes like the ones shown above will be used to show the command line expressions that you should type.</p></li>
<li><p>In upcoming boxes, the prompt itself (<code>[...]$</code>) will not be shown, but only the command line expressions that you type. This is to save space and to allow you for copy-and-pasting (but I recommend typing!).</p></li>
<li><p>Paler gray boxes (below the boxes with command have &amp; with italic text) show the <em>output</em> of commands.</p></li>
</ul>
</div>
</div>
</section>
<section id="a-few-simple-commands-date-whoami-pwd" class="level4">
<h4 class="anchored" data-anchor-id="a-few-simple-commands-date-whoami-pwd">A few simple commands: <code>date</code>, <code>whoami</code>, <code>pwd</code></h4>
<p>The Unix shell comes with hundreds of “commands”: small programs that perform specific actions. If you’re familiar with R or Python, a Unix command is like an R/Python function.</p>
<p>Let’s start with a few simple commands:</p>
<ul>
<li>The <code>date</code> command prints the current date and time:</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">date</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="bash-out"><code>Fri Jan 26 14:31:51 EST 2024</code></pre>
<ul>
<li>The <code>whoami</code> (who-am-i) command prints your username:</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">whoami</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="bash-out"><code>jelmer</code></pre>
<ul>
<li>The <code>pwd</code> (Print Working Directory) command prints the path to the directory you are currently located in:</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="bu">pwd</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="bash-out"><code>/fs/scratch/PAS2250/ENT6703/jelmer</code></pre>
<p>All 3 of those commands provided us with some output. That output was <strong>printed to screen</strong>, which is the default behavior for nearly every Unix command.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Working directory and paths
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>When working in a Unix shell, you are always “in” a specific directory and this is called your <strong>working directory</strong>.</p></li>
<li><p>In a <strong>path</strong> (= location of a file or directory) such as that output by <code>pwd</code>, directories are separated by forward slashes <strong><code>/</code></strong>. (And a <em>leading</em> forward slash, if present, indicates the computer’s <em>root directory</em>.)</p></li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
General shell tips
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>Everything in the shell is <strong>case-sensitive</strong>, including commands and file names.</p></li>
<li><p><strong>Avoid spaces</strong> in file and directory names! Use e.g.&nbsp;underscores or capitalization to distinguish words.</p></li>
</ul>
</div>
</div>
<hr style="height:1pt; visibility:hidden;">
</section>
</section>
<section id="cd-and-command-actions-arguments" class="level3" data-number="5.3">
<h3 data-number="5.3" class="anchored" data-anchor-id="cd-and-command-actions-arguments"><span class="header-section-number">5.3</span> <code>cd</code> and command actions &amp; arguments</h3>
<p>In the above three command line expressions:</p>
<ul>
<li>We merely typed a command and nothing else</li>
<li>The command provided some information, which was printed to screen</li>
</ul>
<p>But many commands perform an <strong>action</strong> other than providing information. For example, you can use the command <strong><code>cd</code></strong> to Change Directory (i.e.&nbsp;change your <em>working</em> dir). And like many commands that perform an action, <code>cd</code> normally has <strong>no output</strong> at all.</p>
<p>Let’s use <code>cd</code> to move to another directory by specifying the <em>path</em> to that directory after the <code>cd</code> command:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> /fs/scratch/PAS2250/ENT6703/share</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="bu">pwd</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="bash-out"><code>/fs/scratch/PAS2250/ENT6703/share</code></pre>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
I will demonstrate “tab completion”!
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<p>In more abstract terms, what we did above was to provide <code>cd</code> with an <strong>argument</strong>, namely the path of the dir to move to. Arguments generally tell commands what file or directory to operate on.</p>
<p>As we’ve seen, then, <code>cd</code> gives no output when it succesfully changed the working directory. But let’s also see what happens when it does not succeed — it gives an error:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> /fs/Scratch/PAS2250</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="bash-out"><code>bash: cd: /fs/Scratch/PAS2250: No such file or directory</code></pre>
<details>
<summary>
<strong>Your Turn</strong>: What was the problem with the path we specified? <em>(Click to see the answer)</em>
</summary>
<p>We used a capital S in <code>/Scratch/</code> — this should have been <code>/scratch/</code>.</p>
<p>As pointed out above, paths (dir and file specifications) are <strong>case-sensitive</strong> on Unix systems!</p>
</details>
<hr style="height:1pt; visibility:hidden;">
</section>
<section id="ls-and-command-options" class="level3" data-number="5.4">
<h3 data-number="5.4" class="anchored" data-anchor-id="ls-and-command-options"><span class="header-section-number">5.4</span> <code>ls</code> and command <em>options</em></h3>
<section id="the-default-behavior-of-ls" class="level4">
<h4 class="anchored" data-anchor-id="the-default-behavior-of-ls">The default behavior of <code>ls</code></h4>
<p>The <code>ls</code> command, short for “list”, will list files and directories:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="bash-out"><code>data  README.md</code></pre>
<p><em>(You should still be in <code>/fs/scratch/PAS2250/ENT6703/share</code>. If not, <code>cd</code> there first.)</em></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Side note: <code>ls</code> output colors <em>(click to expand)</em>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Unfortunately, the <code>ls</code> output shown above does not show the different colors you should see in your shell — here are some of the most common ones:</p>
<ul>
<li>Entries in <span style="color: #0328fc">blue</span> are directories (like <code>data</code> and <code>metadata</code> above)</li>
<li>Entries in black are regular files (like <code>README.md</code> above)</li>
<li>Entries in <span style="color: #d92118">red</span> are compressed files (we’ll see an example soon).</li>
</ul>
</div>
</div>
</div>
<p>This default way that <code>ls</code> shows the output can be changed by providing <code>ls</code> with <strong>options</strong>.</p>
</section>
<section id="options-to-ls" class="level4">
<h4 class="anchored" data-anchor-id="options-to-ls">Options (to <code>ls</code>)</h4>
<p>In general, whereas arguments tell a command <em>what to operate on</em>, options will <em>modify its behavior</em>. For example, we can call <code>ls</code> with the <strong>option <code>-l</code></strong> (a dash followed by a lowercase L):</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span> <span class="at">-l</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="bash-out"><code>total 17
drwxr-xr-x 5 jelmer PAS0471 4096 Jan 21 12:39 data
-rw-r--r-- 1 jelmer PAS0471 1502 Jan 22 11:04 README.md</code></pre>
<p>Notice that it lists the same items as our first <code>ls</code> call above, but <strong>printed in a different format</strong>: one item per line, with additional information included, such as the date and time each file was last modified, and the file sizes in bytes (to the left of the date).</p>
<p>Let’s add another option, <code>-h</code>:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span> <span class="at">-l</span> <span class="at">-h</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="bash-out"><code>total 17K
drwxr-xr-x 5 jelmer PAS0471 4.0K Jan 21 12:39 data
-rw-r--r-- 1 jelmer PAS0471 1.5K Jan 22 11:04 README.md</code></pre>
<details>
<summary>
<strong>Your Turn</strong>: What is different about the output, and what do you think that means? <em>(Click to see the answer)</em>
</summary>
<p>The only difference is in the format of the column reporting the sizes of the items listed.</p>
<p>We now have “Human-readable filesizes” (hence <code>-h</code>), where sizes on the scale of kilobytes will be shown with <code>K</code>s, of megabytes with <code>M</code>s, and of gigabytes with <code>G</code>s. That can be really useful especially for very large files.</p>
</details>
<p>Conveniently, options can be pasted together as follows:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span> <span class="at">-lh</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="combining-options-and-arguments" class="level4">
<h4 class="anchored" data-anchor-id="combining-options-and-arguments">Combining options and arguments</h4>
<p>Arguments to <code>ls</code> should be <strong>dirs or files to operate on</strong>. For example, if we wanted to see what’s inside the <code>data</code> dir, instead of inside our working dir, we could type:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span> data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="bash-out"><code>fastq  meta  ref</code></pre>
<p>The <code>data</code> dir appears to contain three (sub)dirs with different kinds of data. We’ll talk in detail about that later, but for now let’s look inside the <code>fastq</code> dir:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span> data/fastq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="bash-out"><code>ERR10802863_R1.fastq.gz  ERR10802865_R2.fastq.gz  ERR10802868_R1.fastq.gz  ERR10802870_R2.fastq.gz  ERR10802875_R1.fastq.gz  ERR10802877_R2.fastq.gz  ERR10802880_R1.fastq.gz  ERR10802882_R2.fastq.gz  ERR10802885_R1.fastq.gz
ERR10802863_R2.fastq.gz  ERR10802866_R1.fastq.gz  ERR10802868_R2.fastq.gz  ERR10802871_R1.fastq.gz  ERR10802875_R2.fastq.gz  ERR10802878_R1.fastq.gz  ERR10802880_R2.fastq.gz  ERR10802883_R1.fastq.gz  ERR10802885_R2.fastq.gz
ERR10802864_R1.fastq.gz  ERR10802866_R2.fastq.gz  ERR10802869_R1.fastq.gz  ERR10802871_R2.fastq.gz  ERR10802876_R1.fastq.gz  ERR10802878_R2.fastq.gz  ERR10802881_R1.fastq.gz  ERR10802883_R2.fastq.gz  ERR10802886_R1.fastq.gz
ERR10802864_R2.fastq.gz  ERR10802867_R1.fastq.gz  ERR10802869_R2.fastq.gz  ERR10802874_R1.fastq.gz  ERR10802876_R2.fastq.gz  ERR10802879_R1.fastq.gz  ERR10802881_R2.fastq.gz  ERR10802884_R1.fastq.gz  ERR10802886_R2.fastq.gz
ERR10802865_R1.fastq.gz  ERR10802867_R2.fastq.gz  ERR10802870_R1.fastq.gz  ERR10802874_R2.fastq.gz  ERR10802877_R1.fastq.gz  ERR10802879_R2.fastq.gz  ERR10802882_R1.fastq.gz  ERR10802884_R2.fastq.gz</code></pre>
<p>Ah, FASTQ files! These contain our sequence data, and we’ll go and explore them in a bit.</p>
<p>Finally, we can <strong>combine options and arguments</strong>, and let’s do so take a closer look at our dir with FASTQ files — now the <code>-h</code> option is especially useful and allows us see that the FASTQ files are 21-22 Mb in size:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span> <span class="at">-lh</span> data/fastq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="bash-out"><code>total 941M
-rw-r--r-- 1 jelmer PAS0471 21M Jan 21 13:34 ERR10802863_R1.fastq.gz
-rw-r--r-- 1 jelmer PAS0471 22M Jan 21 13:34 ERR10802863_R2.fastq.gz
-rw-r--r-- 1 jelmer PAS0471 21M Jan 21 13:34 ERR10802864_R1.fastq.gz
-rw-r--r-- 1 jelmer PAS0471 22M Jan 21 13:34 ERR10802864_R2.fastq.gz
-rw-r--r-- 1 jelmer PAS0471 22M Jan 21 13:34 ERR10802865_R1.fastq.gz
-rw-r--r-- 1 jelmer PAS0471 22M Jan 21 13:34 ERR10802865_R2.fastq.gz
-rw-r--r-- 1 jelmer PAS0471 21M Jan 21 13:34 ERR10802866_R1.fastq.gz
-rw-r--r-- 1 jelmer PAS0471 22M Jan 21 13:34 ERR10802866_R2.fastq.gz
[...output truncated...]</code></pre>
<details>
<summary>
<i class="fa-solid fa-user-edit" aria-label="user-edit"></i> <strong>Your Turn</strong>: List the files in the <code>data/ref</code> dir. What are the file sizes? <em>(Click for the solution)</em>
</summary>
<div class="sourceCode" id="cb27"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span> <span class="at">-lh</span> data/ref</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="bash-out"><code>total 670M
-rw-r--r-- 1 jelmer PAS0471 547M Jan 20 22:34 GCF_016801865.2.fna
-rw-r--r-- 1 jelmer PAS0471 123M Jan 20 22:34 GCF_016801865.2.gtf</code></pre>
<p>The <code>.fna</code> file (this is the genome assembly nucleotide FASTA file) is 547 Mb (not bases but bytes!), and the <code>.gtf</code> file (this is the annotation file) is 123 Mb.</p>
</details>
<hr style="height:1pt; visibility:hidden;">
</section>
</section>
<section id="a-few-more-general-shell-tips" class="level3" data-number="5.5">
<h3 data-number="5.5" class="anchored" data-anchor-id="a-few-more-general-shell-tips"><span class="header-section-number">5.5</span> A few more general shell tips</h3>
<ul>
<li><p><strong>Command history:</strong> If you hit the <kbd>⇧</kbd> (up arrow) once, you’ll retrieve your most recent command, and if you keep hitting it, you’ll go further back. The<kbd>⇩</kbd> (down arrow) will go the other way: towards the present.</p></li>
<li><p>Your cursor can be anywhere on a line (not just at the end) when you press <kbd>Enter</kbd> to execute a command!</p></li>
<li><p>If your <strong>prompt is missing</strong>, the shell is either still busy executing your command, or you typed an incomplete command. To abort in either of these two scenarios, press <kbd>Ctrl</kbd>+<kbd>C</kbd> and you’ll get your prompt back.</p></li>
<li><p>Anything that comes after a <code>#</code> is considered a comment instead of code!</p></li>
</ul>
<div class="sourceCode" id="cb29"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This entire line is a comment - you can run it and nothing will happen</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="bu">pwd</span>    <span class="co"># 'pwd' will be executed but everything after the '#' is ignored</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="bash-out"><code>/fs/scratch/PAS2250/ENT6703/jelmer</code></pre>
<hr style="height:1pt; visibility:hidden;">
<details>
<summary>
<i class="fa-solid fa-user-edit" aria-label="user-edit"></i> <strong>Your Turn</strong>: Move into your personal directory, and then back into the <code>share</code> dir <em>(Click for the solution)</em>
</summary>
<div class="sourceCode" id="cb31"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> /fs/scratch/PAS2250/ENT6703/jelmer</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> /fs/scratch/PAS2250/ENT6703/share</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<details>
<summary>
<i class="fa-solid fa-user-edit" aria-label="user-edit"></i> <strong>Your Turn</strong>: Use the command history (arrows) to repeat the previous exercise without typing anything.
</summary>
</details>
<hr style="height:1pt; visibility:hidden;">
<details>
<summary>
<i class="fa-solid fa-user-edit" aria-label="user-edit"></i> <strong>Your Turn (Bonus)</strong>: Two periods <code>..</code> means the directory “one level up” (towards the computer’s root dir): running <code>cd ..</code> will move you one dir level up. Try to make use of this move into your personal dir and back to <code>share</code> again, instead of using the “full paths” like above. <em>(Click for the solution)</em>
</summary>
<div class="sourceCode" id="cb32"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> ../jelmer</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> ../share</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>A little more detail about this, for those that are interested:</p>
<ul>
<li><p>Paths that start with a <code>/</code>, i.e.&nbsp;paths that start from the computer’s root directory, are called “absolute” or “full paths” (you can think of them as GPS coordinates, they work regardless of where you are located).</p></li>
<li><p>Paths that do not start with <code>/</code> (are always supposed to) start from your current working directory and are called “relative paths”. We’ve used them above with <code>ls data</code> and <code>ls data/fastq</code>. The <code>..</code>, then, is a mechanism to go “up” in the dir hierarchy when using a relative path! They work more like directions along the lines of “take the second left” in the sense that they depend on your current location.</p></li>
</ul>
</details>
<details>
<summary>
<i class="fa-solid fa-user-edit" aria-label="user-edit"></i> <strong>Your Turn (Bonus)</strong>: Practice aborting commands (<em>Click for the instructions</em>)
</summary>
<p>To simulate a long-running command that we may want to abort, we can use the <code>sleep</code> command, which will make the computer wait for a specified amount of time until giving your prompt back:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sleep</span> 60s</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Run that command and instead of waiting for the full 60 seconds, press <kbd>Ctrl</kbd> + <kbd>C</kbd> to get your prompt back sooner!</p>
<p>Or, an example of an incomplete command (an opening parenthesis <code>(</code>):</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="kw">(</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Run the code above, see what happens, and press <kbd>Ctrl</kbd> + <kbd>C</kbd> to get your prompt back.</p>
</details>
<p><br></p>
<hr>
<p><br></p>
</section>
</section>
<section id="appendix-further-learning" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="appendix-further-learning"><span class="header-section-number">6</span> Appendix: Further learning</h2>
<section id="resources-for-further-learning" class="level4">
<h4 class="anchored" data-anchor-id="resources-for-further-learning">Resources for further learning</h4>
<ul>
<li><strong>OSC</strong>
<ul>
<li><a href="https://mcic-osu.github.io/rnaseq-intro/modules/A01_osc.html" class="uri">https://mcic-osu.github.io/rnaseq-intro/modules/A01_osc.html</a></li>
<li><a href="https://www.osc.edu/supercomputing/training">OSC’s online asynchronous courses</a></li>
<li><a href="https://www.osc.edu/resources/getting_started/new_user_resource_guide">OSC’s new User Resource Guide</a></li>
</ul></li>
<li><strong>VS Code</strong>
<ul>
<li><a href="https://mcic-osu.github.io/rnaseq-intro/modules/A02_vscode.html" class="uri">https://mcic-osu.github.io/rnaseq-intro/modules/A02_vscode.html</a></li>
</ul></li>
<li><strong>Unix shell</strong>
<ul>
<li><a href="https://www.osc.edu/documentation/tutorials/unix_basics">OSC’s UNIX Basics</a></li>
<li><a href="https://mcic-osu.github.io/rnaseq-intro/modules/A03_shell1.html" class="uri">https://mcic-osu.github.io/rnaseq-intro/modules/A03_shell1.html</a></li>
<li><a href="https://mcic-osu.github.io/rnaseq-intro/modules/A04_shell2.html" class="uri">https://mcic-osu.github.io/rnaseq-intro/modules/A04_shell2.html</a></li>
<li><a href="https://www.learnenough.com/command-line-tutorial" class="uri">https://www.learnenough.com/command-line-tutorial</a></li>
<li><a href="https://cvw.cac.cornell.edu/Linux/" class="uri">https://cvw.cac.cornell.edu/Linux/</a></li>
</ul></li>
<li><strong>OSU courses</strong>
<ul>
<li>Genome Analytics course (<code>HCS 7004</code>)</li>
<li>Microbiome Informatics course (<code>MICRBIO 8161</code>)</li>
<li>Computing Skills for Omics Data (<code>PLNTPTH 5006</code>, taught as IS in SP24 2nd session as <code>PLNTPTH 6193</code>)</li>
</ul></li>
<li><strong>Online workshop/course material</strong>
<ul>
<li>Workshop “<a href="https://mcic-osu.github.io/cl-workshop-22">Command line basics for genomic analysis at OSC</a>” (Mike Sovic &amp; Jelmer Poelstra, 2022)</li>
<li>Course <a href="https://mcic-osu.github.io/pracs-sp21/">“Practical Computing Skills for Biologists”</a> (Jelmer Poelstra, 2021)</li>
</ul></li>
<li><strong>Books</strong>
<ul>
<li><a href="https://open.oregonstate.education/computationalbiology">A Primer for Computational Biology</a> (Shawn T. O’ Neil, 2019) <em>(available online!)</em></li>
<li>Computing Skills for Biologists: A Toolbox (Wilmes &amp; Allesino, 2019)</li>
<li>Bioinformatics Data Skills (Vince Buffalo, 2015)</li>
<li>The Linux Command Line (William Shotts, 2019)</li>
</ul></li>
</ul>


</section>
</section>


<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Cloud computing is an alternative, but won’t be covered here.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>If you were added to another project than <code>PAS2250</code>, you should have at least 3: <code>PAS2250</code> does not have a “project dir”, but most projects do<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Though this is not meant for large (&gt;1 GB) transfers. Different methods are available for those but are outside the scope of this introductions.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Note that we’ll be kicked off as soon as that amount of time has passed!<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>This will be your starting location in the file system, we’ll talk more about working dirs in a little bit.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>